#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
@author : Romain Graux
@date : 2021 Sep 29, 11:47:38
@last modified : 2021 Dec 09, 13:16:54
"""

import numpy as np


def extended_euclidian_algorithm(a, b):
    """
    returns d, u, v such that d = au + bv = gcd(a, b)
    """
    x = np.array([a, 1, 0])
    y = np.array([b, 0, 1])

    while y[0] > 0:
        q = x[0] // y[0]
        x, y = y, x - q * y
    return x


if __name__ == "__main__":
    x, n = (
        7,
        21335316066128797519463084172272703166737502747197517673848047837193111886887365442563171572035933560314081879983154062266896888634884689791661763425405841128187015924659341436952792378947425671274780690336152283487081084519043968398045338123209097338040673021614233803307152130932843322032737261013417704861691891234258737673367659444996020292995560976836555190114965235167403243345171588274464985163974749140298388849211002233366094363540346497850326178863270705679029298299866368073567853748123265372956018043234145727987776184034455431335207489030168926271570445746870875582065558220412871008075419280845447595809,
    )
    gcd, u, v = extended_euclidian_algorithm(x, n)
    print(gcd, u, v)
